#!/usr/bin/env python3
# coding: utf8

# Author: Lenz Furrer, 2018


'''
Filename listings for train/dev/test and different folds.
'''


import itertools as it


def docs(subset):
    '''
    Get document IDs for the given subset.
    '''
    subdir = 'test' if subset == 'test' else 'train'
    return subdir, _docs(subset)


def _docs(subset):
    # Predefined test set.
    if subset == 'test':
        return _test

    # Non-folded train/dev split.
    if subset == 'dev':
        return _dev0
    if subset == 'train':
        exclude = set(_dev0)
        ids = it.filterfalse(exclude.__contains__, it.chain(*_folds))
        return list(ids)

    # Folded train/dev split.
    label, n = _split_subset_label(subset)
    if label == 'dev':
        return _folds[n]
    if label == 'train':
        ids = it.chain(*_folds[:n], *_folds[n+1:])
        return list(ids)
    raise ValueError('invalid subset: {}'.format(subset))


def _split_subset_label(label):
    fold = label.lstrip('traindev')
    fold = int(fold) - 1
    label = label.rstrip('12345')
    return label, fold


# Test set provided by the shared-task organisers (99 docs).
_test = '''
00176-102920-ECHO_REPORT
00381-006281-DISCHARGE_SUMMARY
00534-017453-DISCHARGE_SUMMARY
00534-100076-ECHO_REPORT
01160-000945-DISCHARGE_SUMMARY
01163-001840-DISCHARGE_SUMMARY
01222-104065-ECHO_REPORT
02740-024700-DISCHARGE_SUMMARY
03087-026480-DISCHARGE_SUMMARY
03298-014440-DISCHARGE_SUMMARY
03628-023268-DISCHARGE_SUMMARY
03835-028462-DISCHARGE_SUMMARY
04082-167766-RADIOLOGY_REPORT
04525-003099-DISCHARGE_SUMMARY
04882-004677-DISCHARGE_SUMMARY
04995-028156-DISCHARGE_SUMMARY
05065-011493-DISCHARGE_SUMMARY
05163-019624-DISCHARGE_SUMMARY
05382-010331-DISCHARGE_SUMMARY
05837-000274-DISCHARGE_SUMMARY
06134-005003-DISCHARGE_SUMMARY
06557-009968-DISCHARGE_SUMMARY
07214-025053-DISCHARGE_SUMMARY
07546-000040-DISCHARGE_SUMMARY
07683-016743-DISCHARGE_SUMMARY
07797-005646-DISCHARGE_SUMMARY
08216-388895-RADIOLOGY_REPORT
08324-097667-ECHO_REPORT
08415-016301-DISCHARGE_SUMMARY
08786-003318-DISCHARGE_SUMMARY
08990-002227-DISCHARGE_SUMMARY
09248-026497-DISCHARGE_SUMMARY
09339-028983-DISCHARGE_SUMMARY
09531-108127-ECHO_REPORT
09602-000963-DISCHARGE_SUMMARY
09703-109051-ECHO_REPORT
10434-169426-RADIOLOGY_REPORT
10539-022213-DISCHARGE_SUMMARY
10689-110055-ECHO_REPORT
10773-027033-DISCHARGE_SUMMARY
11098-004672-DISCHARGE_SUMMARY
11378-103592-ECHO_REPORT
11392-010791-DISCHARGE_SUMMARY
11552-026221-DISCHARGE_SUMMARY
11681-022505-DISCHARGE_SUMMARY
12125-022364-DISCHARGE_SUMMARY
12530-004020-DISCHARGE_SUMMARY
12582-011060-DISCHARGE_SUMMARY
12618-027862-DISCHARGE_SUMMARY
12627-109059-ECHO_REPORT
13990-101915-ECHO_REPORT
14285-022846-DISCHARGE_SUMMARY
15021-016750-DISCHARGE_SUMMARY
15230-012950-DISCHARGE_SUMMARY
15664-014779-DISCHARGE_SUMMARY
15751-026988-DISCHARGE_SUMMARY
15789-007213-DISCHARGE_SUMMARY
16055-152402-RADIOLOGY_REPORT
16072-170823-RADIOLOGY_REPORT
16134-204168-RADIOLOGY_REPORT
16247-028319-DISCHARGE_SUMMARY
16660-004075-DISCHARGE_SUMMARY
16677-010128-DISCHARGE_SUMMARY
16743-013010-DISCHARGE_SUMMARY
16997-000825-DISCHARGE_SUMMARY
17054-016976-DISCHARGE_SUMMARY
17097-368450-RADIOLOGY_REPORT
17467-010718-DISCHARGE_SUMMARY
17583-022047-DISCHARGE_SUMMARY
17644-017974-DISCHARGE_SUMMARY
17652-018982-DISCHARGE_SUMMARY
17774-014129-DISCHARGE_SUMMARY
18108-381702-RADIOLOGY_REPORT
18114-360237-RADIOLOGY_REPORT
18317-007698-DISCHARGE_SUMMARY
18531-010240-DISCHARGE_SUMMARY
19138-025729-DISCHARGE_SUMMARY
19154-166217-RADIOLOGY_REPORT
19596-007256-DISCHARGE_SUMMARY
19778-001791-DISCHARGE_SUMMARY
19911-175533-RADIOLOGY_REPORT
20223-103427-ECHO_REPORT
20389-024150-DISCHARGE_SUMMARY
20442-023289-DISCHARGE_SUMMARY
20701-013632-DISCHARGE_SUMMARY
20706-009354-DISCHARGE_SUMMARY
21115-101632-ECHO_REPORT
21312-018707-DISCHARGE_SUMMARY
21815-002962-DISCHARGE_SUMMARY
21951-203738-RADIOLOGY_REPORT
21979-010316-DISCHARGE_SUMMARY
22159-004946-DISCHARGE_SUMMARY
22788-021533-DISCHARGE_SUMMARY
24307-009748-DISCHARGE_SUMMARY
24435-000622-DISCHARGE_SUMMARY
24786-014472-DISCHARGE_SUMMARY
25150-027400-DISCHARGE_SUMMARY
25775-007416-DISCHARGE_SUMMARY
26522-011368-DISCHARGE_SUMMARY
'''.split()

# Preliminary non-folded train/dev split (149/50).
_dev0 = '''
01314-028800-DISCHARGE_SUMMARY
02115-010823-DISCHARGE_SUMMARY
02652-006395-DISCHARGE_SUMMARY
04266-000520-DISCHARGE_SUMMARY
04303-005081-DISCHARGE_SUMMARY
05062-230044-RADIOLOGY_REPORT
05797-095003-ECG_REPORT
06292-371824-RADIOLOGY_REPORT
06445-096221-ECHO_REPORT
06653-081911-ECG_REPORT
07048-294691-RADIOLOGY_REPORT
07514-025655-DISCHARGE_SUMMARY
07908-129574-RADIOLOGY_REPORT
08114-027513-DISCHARGE_SUMMARY
08870-061373-ECG_REPORT
08951-002958-DISCHARGE_SUMMARY
09337-018472-DISCHARGE_SUMMARY
09569-067879-ECG_REPORT
10588-105794-ECHO_REPORT
10612-047357-ECG_REPORT
10644-007491-DISCHARGE_SUMMARY
10691-220707-RADIOLOGY_REPORT
11801-104538-ECHO_REPORT
12050-081563-ECG_REPORT
12748-021750-DISCHARGE_SUMMARY
13033-020154-DISCHARGE_SUMMARY
13265-104380-ECHO_REPORT
13913-106200-ECHO_REPORT
14493-110891-RADIOLOGY_REPORT
14522-104279-ECHO_REPORT
15272-026154-DISCHARGE_SUMMARY
15737-095456-ECHO_REPORT
15770-109559-ECHO_REPORT
18318-102656-ECHO_REPORT
18426-060090-ECG_REPORT
18912-067495-ECG_REPORT
19623-085193-ECG_REPORT
19649-021294-DISCHARGE_SUMMARY
21219-092548-ECG_REPORT
21273-244548-RADIOLOGY_REPORT
21280-272404-RADIOLOGY_REPORT
21349-034056-ECG_REPORT
21647-105660-ECHO_REPORT
21662-107599-ECHO_REPORT
22225-075494-ECG_REPORT
22818-041469-ECG_REPORT
22891-058961-ECG_REPORT
25585-058370-ECG_REPORT
25950-160092-RADIOLOGY_REPORT
26176-226973-RADIOLOGY_REPORT'''.split()

# 5-fold train/dev split (40/40/40/40/39).
_dev1 = '''
00098-016139-DISCHARGE_SUMMARY
00500-097836-ECHO_REPORT
00587-400001-RADIOLOGY_REPORT
01114-083601-ECG_REPORT
01234-029456-DISCHARGE_SUMMARY
01455-067052-ECG_REPORT
02034-037300-ECG_REPORT
02115-010823-DISCHARGE_SUMMARY
02136-017465-DISCHARGE_SUMMARY
03066-084521-ECG_REPORT
03273-009330-DISCHARGE_SUMMARY
03392-360395-RADIOLOGY_REPORT
03702-098383-ECHO_REPORT
05308-090812-ECG_REPORT
07700-413490-RADIOLOGY_REPORT
07780-347384-RADIOLOGY_REPORT
08014-097374-ECHO_REPORT
09569-067879-ECG_REPORT
11439-014138-DISCHARGE_SUMMARY
12050-081563-ECG_REPORT
13265-104380-ECHO_REPORT
14108-340203-RADIOLOGY_REPORT
14522-104279-ECHO_REPORT
14708-006815-DISCHARGE_SUMMARY
15621-077411-ECG_REPORT
15737-095456-ECHO_REPORT
16013-015541-DISCHARGE_SUMMARY
16093-011230-DISCHARGE_SUMMARY
16817-077812-ECG_REPORT
17090-026395-DISCHARGE_SUMMARY
17522-024788-DISCHARGE_SUMMARY
18076-246143-RADIOLOGY_REPORT
19623-085193-ECG_REPORT
20038-028322-DISCHARGE_SUMMARY
21280-272404-RADIOLOGY_REPORT
21286-109632-ECHO_REPORT
21662-107599-ECHO_REPORT
22891-058961-ECG_REPORT
25003-338492-RADIOLOGY_REPORT
26563-387055-RADIOLOGY_REPORT
'''.split()

_dev2 = '''
02405-069810-ECG_REPORT
02410-026171-DISCHARGE_SUMMARY
02652-006395-DISCHARGE_SUMMARY
04269-027967-DISCHARGE_SUMMARY
05367-106998-ECHO_REPORT
05797-095003-ECG_REPORT
05955-087704-ECG_REPORT
06292-371824-RADIOLOGY_REPORT
07048-294691-RADIOLOGY_REPORT
07352-013977-DISCHARGE_SUMMARY
07514-025655-DISCHARGE_SUMMARY
07786-029701-ECG_REPORT
07908-129574-RADIOLOGY_REPORT
07968-074957-ECG_REPORT
08114-027513-DISCHARGE_SUMMARY
08380-043167-ECG_REPORT
08870-061373-ECG_REPORT
09775-416048-RADIOLOGY_REPORT
13913-106200-ECHO_REPORT
14158-075452-ECG_REPORT
14822-000161-DISCHARGE_SUMMARY
14897-025566-DISCHARGE_SUMMARY
15295-348292-RADIOLOGY_REPORT
15770-109559-ECHO_REPORT
17336-021181-DISCHARGE_SUMMARY
17451-147855-RADIOLOGY_REPORT
18908-109838-ECHO_REPORT
19155-103735-ECHO_REPORT
19584-178988-RADIOLOGY_REPORT
19709-026760-DISCHARGE_SUMMARY
20050-395622-RADIOLOGY_REPORT
20145-362538-RADIOLOGY_REPORT
21349-034056-ECG_REPORT
21967-106697-ECHO_REPORT
21971-062555-ECG_REPORT
22230-040122-ECG_REPORT
22743-004908-DISCHARGE_SUMMARY
23389-095475-ECHO_REPORT
24432-013472-DISCHARGE_SUMMARY
25497-096953-ECHO_REPORT
'''.split()

_dev3 = '''
01427-342648-RADIOLOGY_REPORT
02916-100844-ECHO_REPORT
04266-000520-DISCHARGE_SUMMARY
06091-383430-RADIOLOGY_REPORT
06296-089652-ECG_REPORT
06567-071352-ECG_REPORT
07726-023607-DISCHARGE_SUMMARY
07866-088203-ECG_REPORT
08087-099659-ECHO_REPORT
08703-021487-DISCHARGE_SUMMARY
09030-087790-ECG_REPORT
09166-409725-RADIOLOGY_REPORT
09375-099229-ECHO_REPORT
09622-087101-ECG_REPORT
09963-257487-RADIOLOGY_REPORT
10422-276335-RADIOLOGY_REPORT
10588-105794-ECHO_REPORT
10644-007491-DISCHARGE_SUMMARY
10668-239022-RADIOLOGY_REPORT
10907-103779-ECHO_REPORT
11762-027273-DISCHARGE_SUMMARY
11801-104538-ECHO_REPORT
11823-007872-DISCHARGE_SUMMARY
13033-020154-DISCHARGE_SUMMARY
14835-325902-RADIOLOGY_REPORT
14888-014879-DISCHARGE_SUMMARY
15128-008249-DISCHARGE_SUMMARY
16888-003484-DISCHARGE_SUMMARY
18318-102656-ECHO_REPORT
18321-022756-DISCHARGE_SUMMARY
18426-060090-ECG_REPORT
18912-067495-ECG_REPORT
19012-089185-ECG_REPORT
19140-056193-ECG_REPORT
19267-104724-ECHO_REPORT
19791-003873-DISCHARGE_SUMMARY
20996-105850-ECHO_REPORT
21273-244548-RADIOLOGY_REPORT
23590-017830-DISCHARGE_SUMMARY
25585-058370-ECG_REPORT
'''.split()

_dev4 = '''
00211-027889-DISCHARGE_SUMMARY
01982-060190-ECG_REPORT
03089-097913-ECHO_REPORT
03990-040506-ECG_REPORT
05062-230044-RADIOLOGY_REPORT
05967-095720-ECHO_REPORT
06653-081911-ECG_REPORT
07429-001857-DISCHARGE_SUMMARY
07978-322989-RADIOLOGY_REPORT
09040-052377-ECG_REPORT
09337-018472-DISCHARGE_SUMMARY
09536-102867-ECHO_REPORT
09584-107853-ECHO_REPORT
10101-012638-DISCHARGE_SUMMARY
10612-047357-ECG_REPORT
10668-107159-ECHO_REPORT
10691-220707-RADIOLOGY_REPORT
10906-067559-ECG_REPORT
16333-034160-ECG_REPORT
16994-022078-DISCHARGE_SUMMARY
17217-011306-DISCHARGE_SUMMARY
19230-039952-ECG_REPORT
19246-093639-ECG_REPORT
19649-021294-DISCHARGE_SUMMARY
20288-027184-DISCHARGE_SUMMARY
20400-049875-ECG_REPORT
20807-104709-ECHO_REPORT
21215-274571-RADIOLOGY_REPORT
21305-020227-DISCHARGE_SUMMARY
21413-012450-DISCHARGE_SUMMARY
21633-029484-DISCHARGE_SUMMARY
21647-105660-ECHO_REPORT
21833-003461-DISCHARGE_SUMMARY
22225-075494-ECG_REPORT
22264-260776-RADIOLOGY_REPORT
22682-065777-ECG_REPORT
24638-098945-ECHO_REPORT
24813-183267-RADIOLOGY_REPORT
25950-160092-RADIOLOGY_REPORT
26176-226973-RADIOLOGY_REPORT
'''.split()

_dev5 = '''
00414-104513-ECHO_REPORT
01314-028800-DISCHARGE_SUMMARY
01487-290421-RADIOLOGY_REPORT
04303-005081-DISCHARGE_SUMMARY
06445-096221-ECHO_REPORT
07156-096163-ECHO_REPORT
07452-053844-ECG_REPORT
07761-036998-ECG_REPORT
08951-002958-DISCHARGE_SUMMARY
09001-000036-DISCHARGE_SUMMARY
09665-101538-ECHO_REPORT
10124-289890-RADIOLOGY_REPORT
12152-087134-ECG_REPORT
12156-067807-ECG_REPORT
12748-021750-DISCHARGE_SUMMARY
13101-048474-ECG_REPORT
13594-066846-ECG_REPORT
14493-110891-RADIOLOGY_REPORT
15013-102321-ECHO_REPORT
15272-026154-DISCHARGE_SUMMARY
16044-019401-DISCHARGE_SUMMARY
16597-023618-DISCHARGE_SUMMARY
16660-199016-RADIOLOGY_REPORT
17473-000673-DISCHARGE_SUMMARY
17582-104422-ECHO_REPORT
18673-102519-ECHO_REPORT
21219-092548-ECG_REPORT
21745-025001-DISCHARGE_SUMMARY
22566-151087-RADIOLOGY_REPORT
22739-020612-DISCHARGE_SUMMARY
22818-041469-ECG_REPORT
22821-026994-DISCHARGE_SUMMARY
23039-078076-ECG_REPORT
23298-326737-RADIOLOGY_REPORT
23893-094803-ECG_REPORT
23969-299900-RADIOLOGY_REPORT
25217-257214-RADIOLOGY_REPORT
25844-097135-ECHO_REPORT
26136-101545-ECHO_REPORT
'''.split()

_folds = [_dev1, _dev2, _dev3, _dev4, _dev5]
